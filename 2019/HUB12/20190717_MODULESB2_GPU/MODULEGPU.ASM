;**********************************************************************
;                                                                     *
;    FILENAME:	    MODULEGPU.ASM				                      *
;    DATE:         	2019.08.05                                        *
;    FILE VERSION:                                                    *
;                                                                     *
;    AUTHOR:        KENNYNEUTRON                                      *
;    COMPANY:       GER-PER ENGINEERING                               *
;                                                                     * 
;                                                                     *
;**********************************************************************
;                                                                     *
;    FILES REQUIRED: P16F690.INC                                      *
;                                                                     *
;**********************************************************************
;                                                                     *
;    NOTES:                                                           *
;                                                                     *
;**********************************************************************


	LIST		P=16F690		; LIST DIRECTIVE TO DEFINE PROCESSOR
	#INCLUDE	<P16F690.INC>		; PROCESSOR SPECIFIC VARIABLE DEFINITIONS
	

	__CONFIG    _CP_OFF & _CPD_OFF & _BOR_OFF & _PWRTE_ON & _WDT_OFF & _HS_OSC & _MCLRE_OFF & _FCMEN_OFF & _IESO_OFF

; '__CONFIG' DIRECTIVE IS USED TO EMBED CONFIGURATION DATA WITHIN .ASM FILE.
; THE LABELS FOLLOWING THE DIRECTIVE ARE LOCATED IN THE RESPECTIVE .INC FILE.
; SEE RESPECTIVE DATA SHEET FOR ADDITIONAL INFORMATION ON CONFIGURATION WORD.






;***** VARIABLE DEFINITIONS
W_TEMP		EQU	0X7E			; VARIABLE USED FOR CONTEXT SAVING
STATUS_TEMP	EQU	0X7E			; VARIABLE USED FOR CONTEXT SAVING
PCLATH_TEMP	EQU	0X7F			; VARIABLE USED FOR CONTEXT SAVING




	;#DEFINE C0_ON		BSF PORTC,	0	PORTC0=====>HI
	;#DEFINE C0_OFF		BCF PORTC,	0	PORTC0=====>LO

	#DEFINE	A_ON		BSF	PORTC,	0
	#DEFINE	A_OFF		BCF	PORTC,	0
	
	#DEFINE	B_ON		BSF	PORTC,	1
	#DEFINE	B_OFF		BCF	PORTC,	1

	#DEFINE	DAT_ON		BSF	PORTC,	2
	#DEFINE	DAT_OFF		BCF	PORTC,	2

	#DEFINE	CLK_ON		BSF	PORTC,	7
	#DEFINE	CLK_OFF		BCF	PORTC,	7
	
	#DEFINE	REG_ON		BSF	PORTC,	4
	#DEFINE	REG_OFF		BCF	PORTC,	4
	
	#DEFINE	OE_ON		BSF	PORTC,	5
	#DEFINE	OE_OFF		BCF	PORTC,	5


	#DEFINE	BANK0		BANKSEL	PORTA
	#DEFINE	BANK1		BANKSEL	ADRESL
	#DEFINE	BANK2		BANKSEL	ANSELH

;============================	BANK	0	===========================
CBLOCK 0x20
			DRAM: .80
			DELAYUS, DELAYMS,  MILSEC, ;SEC,DELAYS,	;DELAY VARIABLES
			;=======================================================
			
			LINE
			POINTER
			FONT,NUMBER,BTCOUNT
			HUB,STPT0,STPT1
			CURSORX,LOOP

ENDC
;======================================================================


;============================	BANK	1	===========================
CBLOCK 0XA0
		
		DRAMB: .16
	
		TEMPRAM: .60


		SCROLL,SCROLLCSR,
		
	
		GPUDAT,GDLOOP,GDFSR,GPUDAT_TEMP,CLRTEST
ENDC
;======================================================================



;============================	BANK	2	===========================
CBLOCK 0X120
		VDATA:	.23
		CURSOR_TEMP,HUB_TEMP,WIDTH

ENDC
;======================================================================

;**********************************************************************
	ORG		0X000			; PROCESSOR RESET VECTOR
			GOTO	INIT			;GO TO INITIALIZATION

	
	ORG		0X004			; INTERRUPT VECTOR LOCATION
	MOVWF		W_TEMP			; SAVE OFF CURRENT W REGISTER CONTENTS
	MOVF		STATUS,W		; MOVE STATUS REGISTER INTO W REGISTER
	MOVWF		STATUS_TEMP		; SAVE OFF CONTENTS OF STATUS REGISTER
	MOVF		PCLATH,W		; MOVE PCLATH REGISTER INTO W REGISTER
	MOVWF		PCLATH_TEMP		; SAVE OFF CONTENTS OF PCLATH REGISTER


; ISR CODE CAN GO HERE OR BE LOCATED AS A CALL SUBROUTINE ELSEWHERE

	MOVF		PCLATH_TEMP,W		; RETRIEVE COPY OF PCLATH REGISTER
	MOVWF		PCLATH			; RESTORE PRE-ISR PCLATH REGISTER CONTENTS	
	MOVF		STATUS_TEMP,W		; RETRIEVE COPY OF STATUS REGISTER
	MOVWF		STATUS			; RESTORE PRE-ISR STATUS REGISTER CONTENTS
	SWAPF		W_TEMP,F
	SWAPF		W_TEMP,W		; RESTORE PRE-ISR W REGISTER CONTENTS
	RETFIE					; RETURN FROM INTERRUPT



;$$$$$$$$$$$$$$$$$$$$$	INITIALIZE	$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

;DECLARE PORTC AS OUTPUT HERE:
INIT
BANKSEL	ANSEL
CLRW
MOVWF	ANSEL
MOVWF	ANSELH

BANKSEL	TRISB

MOVLW	B'00110000'
MOVWF	TRISB

BANKSEL	TRISC
MOVLW	B'00001100'
MOVWF	TRISC

BANKSEL	SSPCON

MOVLW	B'00110000'
MOVWF	SSPCON


BANKSEL	TRISA
BCF		TRISA,2
BANKSEL	PORTA
BCF		PORTA,2


BANK0
MOVLW	0
MOVWF	PCLATH


CALL	CLRTRAM
CALL	CLRAM
BANK1
MOVLW	0X00
MOVWF	TEMPRAM+00

MOVLW	0X10
MOVWF	TEMPRAM+01

MOVLW	0X50
MOVWF	TEMPRAM+02

MOVLW	0X55
MOVLW	TEMPRAM+03


MOVLW	4
MOVWF	GPUDAT_TEMP
BANK0
GOTO	MAIN	; GO TO BEGINNING OF PROGRAM
;$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$


;#######################	MAIN PROGRAM  ##########################
MAIN


	CALL	DISPLAY



GOTO	MAIN
;###################################################################
CLRTRAM
	MOVLW	0XB0
	MOVWF	FSR
	MOVLW	.60
	MOVWF	POINTER

CLRT0
	MOVLW	0
	MOVWF	INDF
	INCF	FSR
	DECFSZ	POINTER,F
	GOTO	CLRT0
RETURN


COMCPU2GPU
	BANK1
	CLRF	GPUDAT
	BANK0
	MOVLW	0XB0
	MOVWF	FSR

CCG
	BANK0
	
	MOVLW	.250
	MOVWF	POINTER

	CLRF	W_TEMP
	MOVLW	8
	MOVWF	LOOP
CCG0
	DECFSZ	POINTER,F
	GOTO	CCG1
	GOTO	CCGRET

CCG1
	BTFSS	PORTC,2;ACK?
	GOTO	CCG0
	NOP
	NOP
	NOP
	NOP


CCG2
	BTFSS	PORTC,3		;CLK HI?
	GOTO	$-1
	BTFSS	PORTB,4

	GOTO	DBIT0
	GOTO	DBIT1

DBIT0
	CLRC
	GOTO	$+2	

DBIT1
	SETC



	BTFSC	PORTC,3		;CLK LO?
	GOTO	$-1
	RLF		W_TEMP

	
	DECFSZ	LOOP,F
	GOTO	CCG2
	
	MOVFW	W_TEMP
	MOVWF	INDF
	NOP
	NOP



	BTFSS	PORTC,2
	GOTO	CCG3

	CLRF	W_TEMP
	MOVLW	8
	MOVWF	LOOP
	BANK1
	INCF	GPUDAT
	BANK0
	INCF	FSR
	GOTO	CCG2


CCG3
	
		BCF		W_TEMP,7
		BCF		W_TEMP,6
		BCF		W_TEMP,5
		BCF		W_TEMP,4
	
		MOVFW	W_TEMP
		BANK2
		MOVWF	VDATA+0B
		BANK1
		INCF	GPUDAT
		MOVFW	GPUDAT
		MOVWF	GPUDAT_TEMP
		BANK0
		;CALL	PUTDATA

CCGRET
		NOP
		BANK1
		MOVFW	GPUDAT_TEMP
		MOVWF	GPUDAT
		BANK0
		MOVLW	0
		MOVWF	PCLATH
RETURN








;============	DATALATCH ========
DATALATCH
OE_OFF
REG_OFF

MOVLW	.16
MOVWF	POINTER


DSP0
MOVFW	INDF
MOVWF	SSPBUF

NOP
NOP	
NOP
NOP
NOP
NOP
NOP



INCF	FSR
DECFSZ	POINTER,F
GOTO	DSP0


RETURN
;=================================


;#######################	DISPLAY		########################
DISPLAY
	

	;OE_OFF
	BCF		PORTC,6

	REG_ON
	REG_OFF
	A_OFF

	B_OFF
	;OE_ON

	BSF		PORTC,6
	MOVLW	0
	MOVWF	LINE
	CALL	CLRAM
	CALL	COMCPU2GPU

	CALL	DISPHUB


	
	;OE_OFF
	BCF		PORTC,6

	REG_ON
	REG_OFF
	A_ON
	B_ON
	;OE_ON

	BSF		PORTC,6
	MOVLW	1
	MOVWF	LINE
	CALL	CLRAM
	CALL	COMCPU2GPU
	CALL	DISPHUB
;	CALL	DELAY_ONEMS


	;OE_OFF
	BCF		PORTC,6

	REG_ON
	REG_OFF
	A_OFF
	B_ON
	;OE_ON

	BSF		PORTC,6

	MOVLW	2
	MOVWF	LINE
	CALL	CLRAM
	CALL	COMCPU2GPU
	CALL	DISPHUB
;	CALL	DELAY_ONEMS


	;OE_OFF
	BCF		PORTC,6

	REG_ON
	REG_OFF
	A_ON
	B_OFF
	;OE_ON

	BSF		PORTC,6

	MOVLW	3
	MOVWF	LINE
	CALL	CLRAM
	CALL	COMCPU2GPU
	CALL	DISPHUB
;	CALL	DELAY_ONEMS
RETURN
;###############################################################


CLRDISPLAY
	CALL	CLRTRAM
RETURN


ORG 0X100

PUTDATA
		BANK0
	;	BSF		STATUS,IRP
		MOVFW	PCLATH
		MOVWF	PCLATH_TEMP
		MOVLW	1
		MOVWF	PCLATH


		BANK1
		MOVFW	GPUDAT
		MOVWF	GDLOOP

		MOVLW	0XB0
		MOVWF	GDFSR

PDT0
		MOVFW	GDFSR
		BANK0
		MOVWF	FSR
		CALL	DDECODE
		
		BANK1
		INCF	GDFSR
		DECFSZ	GDLOOP,F
		GOTO	PDT0



;		BANK0
;		MOVFW	STPT0
;		BANK2
;		MOVWF	VDATA+05
;		BANK0
;		MOVFW	STPT1
;		BANK2
;		MOVWF	VDATA+06
;		BANK0


;		MOVLW	0XB0
;		MOVWF	FSR
;		CALL	DDECODE
;		MOVLW	0XB1
;		MOVWF	FSR
;		CALL	DDECODE
;
;
;		MOVLW	0XB2
;		MOVWF	FSR
;		CALL	DDECODE
;		
;
;
;;		MOVLW	0XB3
;;		MOVWF	FSR
;;		CALL	DDECODE
;		BANK2
;		MOVLW	.11
;		ADDWF	CURSOR_TEMP
;		BANK0
;		MOVLW	0XB3
;		MOVWF	FSR
;		CALL	DDECODE
;;
		BANK0
		MOVFW	PCLATH_TEMP
		MOVWF	PCLATH
;	;	BCF		STATUS,IRP
	
RETURN




DDECODE
		BANK0
		MOVLW	1
		MOVWF	PCLATH
		MOVFW	INDF
		BTFSC	STATUS,Z
		RETURN
		MOVWF	STPT0
		MOVWF	STPT1
		BANK1
		MOVWF	CLRTEST
		MOVLW	0XFF
		SUBWF	CLRTEST
		BANK0
		BTFSC	STATUS,Z
		GOTO	CLRDISPLAY
		
		BCF		STPT1,7
		BCF		STPT1,6
		BCF		STPT1,5
		BCF		STPT1,4
		
		CLRC
		RRF		STPT0
		CLRC
		RRF		STPT0
		CLRC
		RRF		STPT0
		CLRC
		RRF		STPT0


	
		MOVFW	STPT0
		ADDWF	PCL
		
		NOP
		GOTO	DCURSOR0
		GOTO	DCURSOR1
		GOTO	DHUB
		GOTO	DFONT0
		GOTO	DFONT1

DCURSOR0
		MOVFW	STPT1
		BANK2
		MOVWF	CURSOR_TEMP
		BANK0
		GOTO	DDRET
DCURSOR1
		MOVFW	STPT1
		BANK2
		MOVWF	CURSOR_TEMP
		MOVLW	.16
		ADDWF	CURSOR_TEMP
		BANK0
		GOTO	DDRET
DHUB
		MOVFW	STPT1
		BANK2
		MOVWF	HUB_TEMP
		BANK0
		GOTO	DDRET
DFONT0
		MOVLW	0
		MOVWF	FONT

		MOVFW	STPT1
		MOVWF	NUMBER
		;BCF		STATUS,IRP
		BANK2
		MOVFW	HUB_TEMP
		BANK0
		MOVWF	HUB



		BANK2
		MOVFW	CURSOR_TEMP
		BANK0
		MOVWF	CURSORX
		CALL	HUBDUMP

		MOVFW	PCLATH
		MOVWF	PCLATH_TEMP
		MOVLW	9
		MOVWF	PCLATH
		CALL	WIDTHCHECKF0
		
		GOTO	DDRET
DFONT1
		MOVLW	1
		MOVWF	FONT
		
		MOVFW	STPT1
		MOVWF	NUMBER
		BANK2
		MOVFW	HUB_TEMP
		BANK0
		MOVWF	HUB

		BANK2
		MOVFW	CURSOR_TEMP
		BANK0
		MOVWF	CURSORX
		CALL	HUBDUMP
	

		MOVFW	PCLATH
		MOVWF	PCLATH_TEMP
		MOVLW	9
		MOVWF	PCLATH
		CALL	WIDTHCHECKF1



		GOTO	DDRET
		NOP
DDRET
		NOP	
		
RETURN



;==================	DISPLAYING THE DATA RECIEVED 
DISPHUB
	MOVLW	2
	MOVWF	PCLATH
	CALL	PUTDATA



;==================	PLACING THE DATA ================
	BANK0
	MOVLW	0X20
	MOVWF	FSR
	CALL	DATALATCH


	CALL	DATALATCH


	CALL	DATALATCH

	CALL	DATALATCH


	CALL	DATALATCH
	MOVLW	0XA0
	MOVWF	FSR
	CALL	DATALATCH
	
	MOVLW	0
	MOVWF	PCLATH


RETURN




;======================	 NO SCROLL	=================
DONTSCROLLHUB1DIG2
	BANK2
	MOVFW	VDATA+0F
	BANK0
	MOVWF	NUMBER

	MOVLW	1
	MOVWF	CURSORX
	CALL	HUBDUMP
RETURN

DONTSCROLLHUB1DIG1
	BANK2
	MOVFW	VDATA+10
	BANK0
	MOVWF	NUMBER

	MOVLW	.10
	MOVWF	CURSORX
	CALL	HUBDUMP
RETURN

DONTSCROLLHUB1DIG0
	BANK2
	MOVFW	VDATA+11
	BANK0
	MOVWF	NUMBER

	MOVLW	.21
	MOVWF	CURSORX
	CALL	HUBDUMP
RETURN


DONTSCROLLHUB3DIG2
	BANK2
	MOVFW	VDATA+0C
	BANK0
	MOVWF	NUMBER
;	MOVLW	1
;	MOVWF	FONT
;	MOVLW	3
;	MOVWF	HUB
	MOVLW	1
	MOVWF	CURSORX
	CALL	HUBDUMP
RETURN



DONTSCROLLHUB3DIG1
	BANK2
	MOVFW	VDATA+0D
	BANK0
	MOVWF	NUMBER
;	MOVLW	1
;	MOVWF	FONT
;	MOVLW	3
;	MOVWF	HUB
	MOVLW	.10
	MOVWF	CURSORX
	CALL	HUBDUMP
RETURN


DONTSCROLLHUB3DIG0
	BANK2
	MOVFW	VDATA+0E
	BANK0
	MOVWF	NUMBER
;	MOVLW	1
;	MOVWF	FONT
;	MOVLW	3
;	MOVWF	HUB
	MOVLW	.21
	MOVWF	CURSORX
	CALL	HUBDUMP
RETURN
;====================================================	
	



;=======================	CLEAR	RAM		===============
CLRAM
	BANK0
	MOVLW		.80
	MOVWF		POINTER
	MOVLW		DRAM
	MOVWF		FSR  

CLR0
	MOVLW		0XFF
	MOVWF		INDF

	INCF		FSR, F
	DECFSZ		POINTER, F
	GOTO		CLR0

	MOVLW		.16
	MOVWF		POINTER
	MOVLW		0XA0
	MOVWF		FSR  

CLR1
	MOVLW		0XFF
	MOVWF		INDF

	INCF		FSR, F
	DECFSZ		POINTER, F
	GOTO		CLR1
	 
	RETURN
;==========================================================





;==========	DELAY USEC =========
DELAY_US

	MOVWF	DELAYUS

USEC

	NOP
 	NOP
	NOP
	NOP
DECFSZ	DELAYUS,F

GOTO	USEC

RETURN
;=================================



;=========== DELAY ONE MS ========
DELAY_ONEMS

	MOVLW	.5
	MOVWF	LOOP

MSEC
	MOVLW	.200
	CALL	DELAY_US
	DECFSZ	LOOP,F
	GOTO	MSEC

RETURN
;==================================


;=========== DELAY MS	==========
DELAY_MS
	
	MOVWF	DELAYMS
MSEC0
	CALL	DELAY_ONEMS
	DECFSZ	DELAYMS,F
	GOTO	MSEC0
RETURN
;=================================

;=========== DELAY	ONE	SECOND ===
;DELAY_ONESEC
;
;	MOVLW	.5
;	MOVWF	SEC
;SEC0
;	MOVLW	.200
;	CALL	DELAY_MS
;	DECFSZ	SEC,F
;	GOTO	SEC0
;RETURN
;;=================================
;
;;==========	DELAY SEC ============
;DELAY_SEC
;
;	MOVWF	DELAYS
;SEC1
;	CALL	DELAY_ONESEC
;	DECFSZ	DELAYS,F
;	GOTO	SEC1
;RETURN
;;=================================














ORG 0X200
;######################### HUB DISPLAYS ###################


;============================
HUBDUMP
;============================
;	CALL	CLRAM
	BANK0
	MOVLW	2
	MOVWF	PCLATH

	MOVFW	HUB
	ADDWF	PCL,F
	
	NOP
	GOTO	HB1
	GOTO	HB2
	GOTO	HB3
	GOTO	HB4
	GOTO	HB5
	GOTO	HB6


HB6
	MOVLW	0X20
	MOVWF	STPT0
	MOVLW	0X24
	MOVWF	STPT1
	CALL	CURSORTEST


GOTO	HDP1


HB5

	MOVLW	0X30
	MOVWF	STPT0
	MOVLW	0X34
	MOVWF	STPT1
	CALL	CURSORTEST
GOTO	HDP1

HB4
	MOVLW	0X40
	MOVWF	STPT0
	MOVLW	0X44
	MOVWF	STPT1
	CALL	CURSORTEST
GOTO	HDP1


HB3
	MOVLW	0X50
	MOVWF	STPT0
	MOVLW	0X54
	MOVWF	STPT1
	CALL	CURSORTEST
GOTO	HDP1

HB2
	MOVLW	0X60
	MOVWF	STPT0
	MOVLW	0X64
	MOVWF	STPT1
	CALL	CURSORTEST
GOTO	HDP1


HB1
	MOVLW	0XA0
	MOVWF	STPT0
	MOVLW	0XA4
	MOVWF	STPT1
	CALL	CURSORTEST
GOTO	HDP1




HDP1
	MOVFW	FONT
	ADDWF	PCL,F
	
	GOTO	FONT0
	GOTO	FONT1
	


	



FONT0
	MOVFW	LINE
	ADDWF	PCL,F
	GOTO	F0_LINE11
	GOTO	F0_LINE01
	GOTO	F0_LINE10
	GOTO	F0_LINE00


F0_LINE11
;	CALL	CLRAM
	MOVFW	STPT0
	MOVWF	FSR
	MOVLW	.16
	MOVWF	BTCOUNT
	MOVLW	4
	MOVWF	POINTER
	

	
	F0LN11
	CALL	CHAR
	MOVWF	W_TEMP
	CALL	SHIFTDATA

	MOVLW	.4
	SUBWF	BTCOUNT
	INCF	FSR
	DECFSZ	POINTER
	GOTO	F0LN11
RETURN

F0_LINE01
;	CALL	CLRAM
	MOVFW	STPT0
	MOVWF	FSR
	MOVLW	.15
	MOVWF	BTCOUNT
	MOVLW	4
	MOVWF	POINTER
	


	F0LN01
	CALL	CHAR
	MOVWF	W_TEMP
	CALL	SHIFTDATA

	MOVLW	.4
	SUBWF	BTCOUNT
	INCF	FSR
	DECFSZ	POINTER
	GOTO	F0LN01

RETURN

F0_LINE10
;	CALL	CLRAM
	MOVFW	STPT0
	MOVWF	FSR
	MOVLW	.14
	MOVWF	BTCOUNT
	MOVLW	4
	MOVWF	POINTER
	


	F0LN10
	CALL	CHAR
	MOVWF	W_TEMP
	CALL	SHIFTDATA

	MOVLW	.4
	SUBWF	BTCOUNT
	INCF	FSR
	DECFSZ	POINTER
	GOTO	F0LN10

RETURN

F0_LINE00
;	CALL	CLRAM
	MOVFW	STPT0
	MOVWF	FSR
	MOVLW	.13
	MOVWF	BTCOUNT
	MOVLW	4
	MOVWF	POINTER
	

	F0LN00
	CALL	CHAR
	MOVWF	W_TEMP
	CALL	SHIFTDATA

	MOVLW	.4
	SUBWF	BTCOUNT
	INCF	FSR
	DECFSZ	POINTER
	GOTO	F0LN00

RETURN



FONT1
	MOVFW	LINE
	ADDWF	PCL,F
	GOTO	F1_LINE11
	GOTO	F1_LINE01
	GOTO	F1_LINE10
	GOTO	F1_LINE00



F1_LINE11
;	CALL	CLRAM
	MOVFW	STPT0
	MOVWF	FSR
	MOVLW	.31
	MOVWF	BTCOUNT
	MOVLW	4
	MOVWF	POINTER
	
	F1LN11
	CALL	T_CHAR
	MOVWF	W_TEMP
	CALL	SHIFTDATA

	MOVLW	.8
	SUBWF	BTCOUNT
	INCF	FSR
	DECFSZ	POINTER
	GOTO	F1LN11


	MOVFW	STPT1
	MOVWF	FSR
	MOVLW	.32
	MOVWF	BTCOUNT
	MOVLW	4
	MOVWF	POINTER
	
	F1LN112
	CALL	T_CHAR
	MOVWF	W_TEMP
	CALL	SHIFTDATA
	MOVLW	.8
	SUBWF	BTCOUNT
	INCF	FSR
	DECFSZ	POINTER
	GOTO	F1LN112
RETURN

F1_LINE01
;	CALL	CLRAM
	MOVFW	STPT0
	MOVWF	FSR
	MOVLW	.29
	MOVWF	BTCOUNT
	MOVLW	4
	MOVWF	POINTER
	
	F1LN01
	CALL	T_CHAR
	MOVWF	W_TEMP
	CALL	SHIFTDATA

	MOVLW	.8
	SUBWF	BTCOUNT
	INCF	FSR
	DECFSZ	POINTER
	GOTO	F1LN01



	MOVFW	STPT1
	MOVWF	FSR
	MOVLW	.30
	MOVWF	BTCOUNT
	MOVLW	4
	MOVWF	POINTER
	
	F1LN012
	CALL	T_CHAR
	MOVWF	W_TEMP
	CALL	SHIFTDATA
	MOVLW	.8
	SUBWF	BTCOUNT
	INCF	FSR
	DECFSZ	POINTER
	GOTO	F1LN012


RETURN

F1_LINE10
;	CALL	CLRAM
	MOVFW	STPT0
	MOVWF	FSR
	MOVLW	.27
	MOVWF	BTCOUNT
	MOVLW	4
	MOVWF	POINTER
	
	F1LN10
	CALL	T_CHAR
	MOVWF	W_TEMP
	CALL	SHIFTDATA

	MOVLW	.8
	SUBWF	BTCOUNT
	INCF	FSR
	DECFSZ	POINTER
	GOTO	F1LN10


	MOVFW	STPT1
	MOVWF	FSR
	MOVLW	.28
	MOVWF	BTCOUNT
	MOVLW	4
	MOVWF	POINTER
	
	F1LN102
	CALL	T_CHAR
	MOVWF	W_TEMP
	CALL	SHIFTDATA
	MOVLW	.8
	SUBWF	BTCOUNT
	INCF	FSR
	DECFSZ	POINTER
	GOTO	F1LN102

RETURN

F1_LINE00
;	CALL	CLRAM
	MOVFW	STPT0
	MOVWF	FSR
	MOVLW	.25
	MOVWF	BTCOUNT
	MOVLW	4
	MOVWF	POINTER
	
	F1LN00
	CALL	T_CHAR
	MOVWF	W_TEMP
	CALL	SHIFTDATA
	MOVLW	.8
	SUBWF	BTCOUNT
	INCF	FSR
	DECFSZ	POINTER
	GOTO	F1LN00

	MOVFW	STPT1
	MOVWF	FSR
	MOVLW	.26
	MOVWF	BTCOUNT
	MOVLW	4
	MOVWF	POINTER
	
	F1LN002
	CALL	T_CHAR
	MOVWF	W_TEMP
	CALL	SHIFTDATA

	MOVLW	.8
	SUBWF	BTCOUNT
	INCF	FSR
	DECFSZ	POINTER
	GOTO	F1LN002

RETURN
	

;============================



SHIFTDATA
	MOVLW	2
	MOVWF	PCLATH
	MOVFW	CURSORX
	MOVWF	LOOP
	
	BTFSC	STATUS,Z
	GOTO	SHFDT1

	
	
	MOVLW	0XFF
	MOVWF	MILSEC

	SHFDT0
	SETC
	RRF		W_TEMP
	RRF		MILSEC	;TEMPORARY VAR
	DECFSZ	LOOP,F
	GOTO	SHFDT0
	
	MOVFW	W_TEMP
	ANDWF	INDF
	
	MOVLW	4
	ADDWF	FSR

	MOVFW	MILSEC
	ANDWF	INDF

	MOVLW	4
	SUBWF	FSR
	
	RETURN



SHFDT1
	MOVFW	W_TEMP
	ANDWF	INDF	

RETURN

	

CURSORTEST
	MOVFW	PCLATH
	MOVWF	PCLATH_TEMP
	MOVLW	3
	MOVWF	PCLATH
	MOVLW	.23
	MOVWF	MILSEC
	MOVFW	CURSORX
	SUBWF	MILSEC
	BTFSS	STATUS,C
	GOTO	CSRT1

	MOVLW	.15
	MOVWF	MILSEC
	MOVFW	CURSORX
	SUBWF	MILSEC
	BTFSS	STATUS,C
	GOTO	CSRT0

	BTFSS	CURSORX,3
	GOTO	CTRET1
	MOVLW	4
	ADDWF	STPT0
	ADDWF	STPT1
	MOVLW	8
	SUBWF	CURSORX
	GOTO	CTRET1


;CURSOR IS GREATER THAN 16
CSRT0
	MOVLW	8
	ADDWF	STPT0
	ADDWF	STPT1
	MOVLW	.16
	SUBWF	CURSORX
GOTO	CTRET1


;CURSOR IS GREATER THAN 24
CSRT1
	MOVLW	.12
	ADDWF	STPT0
	ADDWF	STPT1
	MOVLW	.24
	SUBWF	CURSORX
GOTO	CTRET1



CTRET1

	MOVFW	PCLATH_TEMP
	MOVWF	PCLATH
RETURN























ORG 0X500
T_CHAR
	MOVLW	5
	MOVWF	PCLATH	
	MOVFW	NUMBER
	ADDWF	PCL,F
	
	GOTO	T_ZERO
	
	GOTO	T_ONE

	GOTO	T_TWO

	GOTO	T_THREE

	GOTO	T_FOUR

	GOTO	T_FIVE

NOP
NOP
NOP
NOP

	INCF	PCLATH
	GOTO	T_CHARB


	T_ZERO
			MOVFW	BTCOUNT
			ADDWF	PCL,F

			DT	.12
			DT	B'11000000',B'11111111'
			DT	B'10000000',B'01111111'
			DT	B'00011110',B'00111111'
			DT	B'00111111',B'00111111'
			DT	B'00111111',B'00111111'
			DT	B'00111111',B'00111111'
			DT	B'00111111',B'00111111'
			DT	B'00111111',B'00111111';
			DT	B'00111111',B'00111111';
			DT	B'00111111',B'00111111'
			DT	B'00111111',B'00111111'
			DT	B'00111111',B'00111111'
			DT	B'00111111',B'00111111'
			DT	B'00011110',B'00111111'
			DT	B'10000000',B'01111111'
			DT	B'11000000',B'11111111'

	T_ONE
			MOVFW	BTCOUNT
			ADDWF	PCL

			DT	.12
			DT	B'11100111',B'11111111'
			DT	B'11100111',B'11111111'
			DT	B'11000111',B'11111111'
			DT	B'10000111',B'11111111'
			DT	B'00100111',B'11111111'
			DT	B'11100111',B'11111111'
			DT	B'11100111',B'11111111'
			DT	B'11100111',B'11111111';
			DT	B'11100111',B'11111111';
			DT	B'11100111',B'11111111'
			DT	B'11100111',B'11111111'
			DT	B'11100111',B'11111111'
			DT	B'11100111',B'11111111'
			DT	B'11100111',B'11111111'
			DT	B'00000000',B'11111111'
			DT	B'00000000',B'11111111'	

	T_TWO
			MOVFW	BTCOUNT
			ADDWF	PCL,F
			
			DT	.12
			DT	B'11000000',B'11111111'
			DT	B'10000000',B'01111111'
			DT	B'00111110',B'00111111'
			DT	B'11111111',B'00111111'
			DT	B'11111111',B'00111111'
			DT	B'11111111',B'00111111'
			DT	B'11111111',B'00111111'
			DT	B'11111110',B'00111111'
			DT	B'11000000',B'01111111'
			DT	B'10000000',B'11111111'
			DT	B'00011111',B'11111111'
			DT	B'00111111',B'11111111'
			DT	B'00111111',B'11111111'
			DT	B'00111111',B'00111111'
			DT	B'00000000',B'00111111'
			DT	B'00000000',B'00111111'
	
	T_THREE
			MOVFW	BTCOUNT
			ADDWF	PCL

			DT	.12
			DT	B'11000000',B'11111111'
			DT	B'10000000',B'01111111'
			DT	B'00011110',B'00111111'
			DT	B'00111111',B'00111111'
			DT	B'11111111',B'00111111'
			DT	B'11111111',B'00111111'
			DT	B'11111110',B'00111111'
			DT	B'11100000',B'01111111';
			DT	B'11100000',B'01111111';
			DT	B'11111110',B'00111111'
			DT	B'11111111',B'00111111'
			DT	B'11111111',B'00111111'
			DT	B'00111111',B'00111111'
			DT	B'00011110',B'00111111'
			DT	B'10000000',B'01111111'
			DT	B'11000000',B'11111111'
	
	T_FOUR
			MOVFW	BTCOUNT
			ADDWF	PCL

			DT	.12
			DT	B'11111111',B'10111111'
			DT	B'11111101',B'00111111'
			DT	B'11111001',B'00111111'
			DT	B'11111001',B'00111111'
			DT	B'11110011',B'00111111'
			DT	B'11100111',B'00111111'
			DT	B'11001111',B'00111111'
			DT	B'10011111',B'00111111';
			DT	B'00111111',B'00111111';
			DT	B'00111111',B'00111111'
			DT	B'00000000',B'00111111'
			DT	B'00000000',B'00111111'
			DT	B'11111111',B'00111111'
			DT	B'11111111',B'00111111'
			DT	B'11111111',B'00111111'
			DT	B'11111111',B'01111111'	

	T_FIVE
			MOVFW	BTCOUNT
			ADDWF	PCL

			DT	.12
			DT	B'00000000',B'00111111'
			DT	B'00000000',B'00111111'
			DT	B'00111111',B'00111111'
			DT	B'00111111',B'01111111'
			DT	B'00111111',B'11111111'
			DT	B'00111111',B'11111111'
			DT	B'00111111',B'11111111'
			DT	B'00000000',B'11111111';
			DT	B'00000000',B'01111111';
			DT	B'11111110',B'00111111'
			DT	B'11111111',B'00111111'
			DT	B'11111111',B'00111111'
			DT	B'00111111',B'00111111'
			DT	B'00011110',B'00111111'
			DT	B'10000000',B'01111111'
			DT	B'11000000',B'11111111'



ORG 0X600
T_CHARB
			MOVLW	6
			MOVWF	PCLATH

			MOVFW	NUMBER
			ADDWF	PCL,F

				RETURN	

				RETURN

				RETURN

				RETURN

				RETURN

				RETURN
				
				GOTO	T_SIX
	
				GOTO	T_SEVEN
		
				GOTO	T_EIGHT
		
				GOTO	T_NINE


			
	T_SIX
			MOVFW	BTCOUNT
			ADDWF	PCL

			DT	.12
			DT	B'11000000',B'01111111'
			DT	B'10000000',B'00111111'
			DT	B'00011110',B'00111111'
			DT	B'00111111',B'00111111'
			DT	B'00111111',B'11111111'
			DT	B'00111111',B'11111111'
			DT	B'00011111',B'11111111'
			DT	B'00000000',B'11111111';
			DT	B'00000000',B'01111111';
			DT	B'00011110',B'00111111'
			DT	B'00111111',B'00111111'
			DT	B'00111111',B'00111111'
			DT	B'00111111',B'00111111'
			DT	B'00011110',B'00111111'
			DT	B'10000000',B'01111111'
			DT	B'11000000',B'11111111'
	
			
	T_SEVEN
			MOVFW	BTCOUNT
			ADDWF	PCL

			DT	.12
			DT	B'00000000',B'00111111'
			DT	B'00000000',B'00111111'
			DT	B'00111111',B'00111111'
			DT	B'00111111',B'00111111'
			DT	B'11111111',B'00111111'
			DT	B'11111111',B'00111111'
			DT	B'11111110',B'00111111'
			DT	B'11111100',B'01111111';
			DT	B'11111000',B'11111111';
			DT	B'11110001',B'11111111'
			DT	B'11100011',B'11111111'
			DT	B'11100111',B'11111111'
			DT	B'11100111',B'11111111'
			DT	B'11100111',B'11111111'
			DT	B'11100111',B'11111111'
			DT	B'11100111',B'11111111'	
	
	T_EIGHT
			MOVFW	BTCOUNT
			ADDWF	PCL

			DT	.12
			DT	B'11000000',B'11111111'
			DT	B'10000000',B'01111111'
			DT	B'00011110',B'00111111'
			DT	B'00111111',B'00111111'
			DT	B'00111111',B'00111111'
			DT	B'00011110',B'00111111'
			DT	B'10000000',B'01111111'
			DT	B'10000000',B'01111111';
			DT	B'00011110',B'00111111';
			DT	B'00111111',B'00111111'
			DT	B'00111111',B'00111111'
			DT	B'00111111',B'00111111'
			DT	B'00111111',B'00111111'
			DT	B'00011110',B'00111111'
			DT	B'10000000',B'01111111'
			DT	B'11000000',B'11111111'	

	T_NINE
			MOVFW	BTCOUNT
			ADDWF	PCL

			DT	.12
			DT	B'11000000',B'11111111'
			DT	B'10000000',B'01111111'
			DT	B'00011110',B'00111111'
			DT	B'00111111',B'00111111'
			DT	B'00111111',B'00111111'
			DT	B'00111111',B'00111111'
			DT	B'00011110',B'00111111'
			DT	B'10000000',B'00111111';
			DT	B'11000000',B'00111111';
			DT	B'11111110',B'00111111'
			DT	B'11111111',B'00111111'
			DT	B'11111111',B'00111111'
			DT	B'00111111',B'00111111'
			DT	B'00011110',B'00111111'
			DT	B'10000000',B'01111111'
			DT	B'11000000',B'11111111'

RETURN

CHAR
	MOVLW	6
	MOVWF	PCLATH


	MOVFW	NUMBER
	ADDWF	PCL,F

	GOTO	ZERO
	
	GOTO	ONE
	
	GOTO	TWO

	GOTO	THREE

	NOP
	NOP
	NOP
	NOP
	NOP
	NOP
	NOP
	NOP
	NOP
	NOP
	NOP

	INCF	PCLATH
	GOTO	CHARB





	ZERO
			MOVFW	BTCOUNT
			ADDWF	PCL, F

			DT	8
			DT	B'11111111'
			DT	B'11111111'
			DT	B'11000111'
			DT	B'10000011'
			DT	B'00010001'
			DT	B'00111001'
			DT	B'00111001'
			DT	B'00111001'
			DT	B'00111001'
			DT	B'00111001'
			DT	B'00111001'
			DT	B'00111001'
			DT	B'00111001'
			DT	B'00010001'
			DT	B'10000011'
			DT	B'11000111'



	ONE
			MOVFW	BTCOUNT
			ADDWF	PCL, F

			DT	7
			DT	B'11111111'
			DT	B'11111111'
			DT	B'11001111'
			DT	B'11001111'
			DT	B'10001111'
			DT	B'00001111'
			DT	B'01001111'
			DT	B'11001111'
			DT	B'11001111'
			DT	B'11001111'
			DT	B'11001111'
			DT	B'11001111'
			DT	B'11001111'
			DT	B'11001111'
			DT	B'00000011'
			DT	B'00000011'


	TWO
			MOVFW	BTCOUNT
			ADDWF	PCL, F

			DT	8
			DT	B'11111111'
			DT	B'11111111'
			DT	B'10000111'
			DT	B'00000011'
			DT	B'00110001'
			DT	B'11111001'
			DT	B'11111001'
			DT	B'11111001'
			DT	B'11110001'
			DT	B'10000011'
			DT	B'00000111'
			DT	B'00111111'
			DT	B'00111111'
			DT	B'00111001'
			DT	B'00000001'
			DT	B'00000001'





				

	THREE
			MOVFW	BTCOUNT
			ADDWF	PCL, F

			DT	8
			DT	B'11111111'
			DT	B'11111111'
			DT	B'10000111'
			DT	B'00000011'
			DT	B'00110001'
			DT	B'11111001'
			DT	B'11111001'
			DT	B'11110001'
			DT	B'10000011'
			DT	B'10000011'
			DT	B'11110001'
			DT	B'11111001'
			DT	B'11111001'
			DT	B'00111001'
			DT	B'00000011'
			DT	B'10000111'

ORG 0X700
CHARB

	MOVLW	7
	MOVWF	PCLATH
	MOVFW	NUMBER
	ADDWF	PCL,F


	RETURN

	RETURN

	RETURN

	RETURN
	
	GOTO	FOUR
	
	GOTO	FIVE
	
	GOTO	SIX
	
	GOTO	SEVEN

	GOTO	EIGHT

	GOTO	NINE

	GOTO	OT

	GOTO	SCOLON

	GOTO	DOT

	GOTO	HOMEPOS

	GOTO	GUESTPOS


	GOTO	COLON
	FOUR
			MOVFW	BTCOUNT
			ADDWF	PCL, F

			DT	8
			DT	B'11111111'
			DT	B'11111111'
			DT	B'11111001'
			DT	B'11111001'
			DT	B'11001001'
			DT	B'11001001'
			DT	B'11001001'
			DT	B'10011001'
			DT	B'00111001'
			DT	B'00111001'
			DT	B'00000001'
			DT	B'00000001'
			DT	B'11111001'
			DT	B'11111001'
			DT	B'11111001'
			DT	B'11111001'

	FIVE
			MOVFW	BTCOUNT
			ADDWF	PCL, F

			DT	8
			DT	B'11111111'
			DT	B'11111111'
			DT	B'00000001'
			DT	B'00000001'
			DT	B'00111001'
			DT	B'00111111'
			DT	B'00111111'
			DT	B'00111111'
			DT	B'00000111'
			DT	B'00000011'
			DT	B'11110001'
			DT	B'11111001'
			DT	B'11111001'
			DT	B'11110001'
			DT	B'00000011'
			DT	B'00000111'



	SIX
			MOVFW	BTCOUNT
			ADDWF	PCL, F

			DT	8
			DT	B'11111111'
			DT	B'11111111'
			DT	B'11000111'
			DT	B'10000011'
			DT	B'00111001'
			DT	B'00111111'
			DT	B'00111111'
			DT	B'00111111'
			DT	B'00100111'
			DT	B'00000011'
			DT	B'00010001'
			DT	B'00111001'
			DT	B'00111001'
			DT	B'00010001'
			DT	B'10000011'
			DT	B'11000111'

	SEVEN	
			MOVFW	BTCOUNT
			ADDWF	PCL, F

			DT	8	
			DT	B'11111111'
			DT	B'11111111'
			DT	B'00000001'
			DT	B'00000001'
			DT	B'00111001'
			DT	B'11111001'
			DT	B'11111001'
			DT	B'11111001'
			DT	B'11110011'
			DT	B'11100111'
			DT	B'11001111'
			DT	B'11001111'
			DT	B'11001111'
			DT	B'11001111'
			DT	B'11001111'
			DT	B'11001111'

				
	EIGHT
			MOVFW	BTCOUNT
			ADDWF	PCL, F

			DT	8
			DT	B'11111111'
			DT	B'11111111'
			DT	B'11000111'
			DT	B'10000011'
			DT	B'00010001'
			DT	B'00111001'
			DT	B'00111001'
			DT	B'10010011'
			DT	B'11000111'
			DT	B'10010011'
			DT	B'00111001'
			DT	B'00111001'
			DT	B'00111001'
			DT	B'00010001'
			DT	B'10000011'
			DT	B'11000111'


	NINE
			MOVFW	BTCOUNT
			ADDWF	PCL, F

			DT	8

			DT	B'11111111'
			DT	B'11111111'
			DT	B'11000111'
			DT	B'10000011'
			DT	B'00010001'
			DT	B'00111001'
			DT	B'00111001'
			DT	B'00111001'
			DT	B'00010001'
			DT	B'10000001'
			DT	B'11001001'
			DT	B'11111001'
			DT	B'00111001'
			DT	B'00010001'
			DT	B'10000011'
			DT	B'11000111'


	OT	
			MOVFW	BTCOUNT
			ADDWF	PCL, F

			DT	8
			DT	B'10000111'
			DT	B'00110011'
			DT	B'00110011'
			DT	B'00110011'
			DT	B'00110011'
			DT	B'00110011'
			DT	B'10000111'
			DT	B'11111111'
			DT	B'00000011'
			DT	B'00000011'
			DT	B'11001111'
			DT	B'11001111'
			DT	B'11001111'
			DT	B'11001111'
			DT	B'11001111'
			DT	B'11111111'
	SCOLON
			MOVFW	BTCOUNT
			ADDWF	PCL, F

			DT	8
			DT	B'11111111'
			DT	B'11111111'
			DT	B'11111111'
			DT	B'00111111'
			DT	B'00111111'
			DT	B'11111111'
			DT	B'11111111'
			DT	B'11111111'
			DT	B'11111111'
			DT	B'11111111'
			DT	B'11111111'
			DT	B'11111111'
			DT	B'00111111'
			DT	B'00111111'
			DT	B'11111111'
			DT	B'11111111'


	DOT
			MOVFW	BTCOUNT
			ADDWF	PCL, F

			DT	8
			DT	B'11111111'
			DT	B'11111111'
			DT	B'11111111'
			DT	B'11111111'
			DT	B'11111111'
			DT	B'11111111'
			DT	B'11111111'
			DT	B'11111111'
			DT	B'11111111'
			DT	B'11111111'
			DT	B'11111111'
			DT	B'11111111'
			DT	B'11111111'
			DT	B'11111111'
			DT	B'00111111'
			DT	B'00111111'

	HOMEPOS
			MOVFW	BTCOUNT
			ADDWF	PCL, F

			DT	8
			DT	B'11111111'
			DT	B'11111111'
			DT	B'11111000'
			DT	B'11110001'
			DT	B'11100011'
			DT	B'11000111'
			DT	B'10001111'
			DT	B'00011111'
			DT	B'00011111'
			DT	B'10001111'
			DT	B'11000111'
			DT	B'11100011'
			DT	B'11110001'
			DT	B'11111000'
			DT	B'11111111'
			DT	B'11111111'
				

	GUESTPOS
			MOVFW	BTCOUNT
			ADDWF	PCL, F

			DT	8
			DT	B'11111111'
			DT	B'11111111'
			DT	B'00011111'
			DT	B'10001111'
			DT	B'11000111'
			DT	B'11100011'
			DT	B'11110001'
			DT	B'11111000'
			DT	B'11111000'
			DT	B'11110001'
			DT	B'11100011'
			DT	B'11000111'
			DT	B'10001111'
			DT	B'00011111'
			DT	B'11111111'
			DT	B'11111111'


	COLON
			MOVFW	BTCOUNT
			ADDWF	PCL, F

			DT	8
			DT	B'11111111'
			DT	B'11111111'
			DT	B'10011111'
			DT	B'00001111'
			DT	B'00001111'
			DT	B'10011111'
			DT	B'11111111'
			DT	B'11111111'
			DT	B'11111111'
			DT	B'11111111'
			DT	B'11111111'
			DT	B'10011111'
			DT	B'00001111'
			DT	B'00001111'
			DT	B'10011111'
			DT	B'11111111'


	
ORG 0X900
WIDTHCHECKF0
		BANK0
		MOVFW	NUMBER
		ADDWF	PCL


		GOTO	WDF07	;0
		GOTO	WDF06	;1
		GOTO	WDF07	;2
		GOTO	WDF07	;3
		GOTO	WDF07	;4
		GOTO	WDF07	;5
		GOTO	WDF07	;6
		GOTO	WDF07	;7
		GOTO	WDF07	;8
		GOTO	WDF07	;9
		GOTO	WDF06	;OT
		GOTO	WDF02	;COLON
		GOTO	WDF02	;DOT
		GOTO	WDF08	;<
		GOTO	WDF08	;>
		GOTO	WDF04
		NOP
		NOP

WDF02
	BANK2
	MOVLW	.3
	ADDWF	CURSOR_TEMP
	GOTO	WCF0RET


WDF04
	BANK2
	MOVLW	.5
	ADDWF	CURSOR_TEMP
	GOTO	WCF0RET


WDF06
	BANK2
	MOVLW	.7
	ADDWF	CURSOR_TEMP
	GOTO	WCF0RET

WDF07
	BANK2
	MOVLW	.8
	ADDWF	CURSOR_TEMP
	GOTO	WCF0RET


WDF08
	BANK2
	MOVLW	.9
	ADDWF	CURSOR_TEMP
	GOTO	WCF0RET

WCF0RET
	BANK0
	MOVFW	PCLATH_TEMP
	MOVWF	PCLATH
	

RETURN



WIDTHCHECKF1
		BANK0
		MOVFW	NUMBER
		ADDWF	PCL


		GOTO	WDF1A	;0
		GOTO	WDF18	;1
		GOTO	WDF1A	;2
		GOTO	WDF1A	;3
		GOTO	WDF1A	;4
		GOTO	WDF1A	;5
		GOTO	WDF1A	;6
		GOTO	WDF1A	;7
		GOTO	WDF1A	;8
		GOTO	WDF1A	;9
		NOP
		NOP
WDF18
	BANK2
	MOVLW	.9
	ADDWF	CURSOR_TEMP
	GOTO	WCF1RET
	
WDF1A
	BANK2
	MOVLW	.11
	ADDWF	CURSOR_TEMP
	GOTO	WCF1RET
	NOP

WCF1RET
	BANK0
	MOVFW	PCLATH_TEMP
	MOVWF	PCLATH
	
		
RETURN


		

	ORG	0X2100				; DATA EEPROM LOCATION
	DE	1,2,3,4				; DEFINE FIRST FOUR EEPROM LOCATIONS AS 1, 2, 3, AND 4




	END                       ; DIRECTIVE 'END OF PROGRAM'

